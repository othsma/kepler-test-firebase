import{j as e}from"./vendor-pdf-renderer-CqWwYyiz.js";import{r as l}from"./vendor-react-DSd34EeT.js";import{u as pe,b as fe,a as je,e as Ne}from"./index-zE7fwD22.js";import{h as X,U as Z,p as ee,D as V,T as se,m as we,d as te,C as ve,H as $e,E as Ce,o as ke}from"./vendor-ui-DyePjxVY.js";import{f as z}from"./vendor-utils-BOCFPwNx.js";import"./vendor-firebase-D9SGlHIe.js";import"./vendor-pdf-utils-CBrSDip1.js";function Le(){const t=pe(s=>s.isDarkMode),{clients:M,addClient:ae,updateClient:re,deleteClient:O,loading:ne,error:J}=fe(),{tickets:H}=je(),{sales:I}=Ne(),[$,_]=l.useState("all"),[ie,de]=l.useState(null),[le,R]=l.useState(null),[oe,ce]=l.useState(new Set),[N,C]=l.useState({name:"",email:"",phone:"",address:""}),[w,k]=l.useState({name:"",email:"",phone:"",address:""}),[b,B]=l.useState(""),[x,K]=l.useState("name"),[p,U]=l.useState("asc"),[o,m]=l.useState(1),[v,Q]=l.useState(10);l.useState(!1);const[h,F]=l.useState(!1),[G,W]=l.useState(10),[Y,S]=l.useState(!1),[g,E]=l.useState(new Set),c=Math.ceil(M.length/v),P=(o-1)*v,A=P+v,u=l.useMemo(()=>{let s=M;if(b.trim()){const a=b.toLowerCase();s=s.filter(n=>n.name.toLowerCase().includes(a)||n.email.toLowerCase().includes(a)||n.phone.toLowerCase().includes(a)||n.address.toLowerCase().includes(a))}return s.sort((a,n)=>{let i=a[x],d=n[x];return x==="createdAt"?(i=new Date(i).getTime(),d=new Date(d).getTime()):(i=i.toLowerCase(),d=d.toLowerCase()),p==="asc"?i<d?-1:i>d?1:0:i>d?-1:i<d?1:0}),s},[M,b,x,p]),y=l.useMemo(()=>h?u.slice(0,G):u.slice(P,A),[u,P,A,h,G]);l.useMemo(()=>({totalPages:c,startIndex:P,endIndex:A,totalItems:u.length}),[c,P,A,u.length]),l.useMemo(()=>{m(1)},[b]),l.useMemo(()=>{m(1)},[x,p]),l.useMemo(()=>{const s=new Map;return{get:a=>{if(!s.has(a)){const n=H.filter(d=>d.clientId===a),i=I.filter(d=>{var r;return((r=d.customer)==null?void 0:r.id)===a});s.set(a,{tickets:n,sales:i})}return s.get(a)}}},[H,I]),l.useEffect(()=>{const s=a=>{if(!(a.target instanceof HTMLInputElement||a.target instanceof HTMLTextAreaElement)&&$==="all")switch(a.key){case"ArrowLeft":a.preventDefault(),!h&&o>1&&m(i=>i-1);break;case"ArrowRight":a.preventDefault(),!h&&o<c&&m(i=>i+1);break;case"Home":a.preventDefault(),h||m(1);break;case"End":a.preventDefault(),h||m(c);break;default:const n=parseInt(a.key);!isNaN(n)&&n>=1&&n<=9&&!h&&(a.preventDefault(),n<=c&&m(n));break}};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[$,o,c,h]),l.useEffect(()=>{const s=new URL(window.location.href);o>1?s.searchParams.set("page",o.toString()):s.searchParams.delete("page"),v!==10?s.searchParams.set("perPage",v.toString()):s.searchParams.delete("perPage"),b?s.searchParams.set("search",b):s.searchParams.delete("search"),x!=="name"?s.searchParams.set("sort",x):s.searchParams.delete("sort"),p!=="asc"?s.searchParams.set("dir",p):s.searchParams.delete("dir"),h?s.searchParams.set("mode","loadmore"):s.searchParams.delete("mode"),window.history.replaceState({},"",s.toString())},[o,v,b,x,p,h]),l.useEffect(()=>{const s=new URL(window.location.href),a=parseInt(s.searchParams.get("page")||"1");a>=1&&m(a);const n=parseInt(s.searchParams.get("perPage")||"10");[10,25,50,100].includes(n)&&Q(n);const i=s.searchParams.get("search");i&&B(i);const d=s.searchParams.get("sort");["name","email","createdAt"].includes(d||"")&&K(d);const r=s.searchParams.get("dir");["asc","desc"].includes(r||"")&&U(r),s.searchParams.get("mode")==="loadmore"&&F(!0)},[]);const me=async s=>{s.preventDefault(),await ae(N),C({name:"",email:"",phone:"",address:""})},ge=s=>{const a=H.filter(i=>i.clientId===s),n=I.filter(i=>{var d;return((d=i.customer)==null?void 0:d.id)===s});return{tickets:a,sales:n}},xe=async s=>{window.confirm("ÃŠtes-vous sÃ»r de vouloir supprimer ce client ?")&&await O(s)},he=s=>{const a=M.find(n=>n.id===s);a&&(R(s),k({name:a.name,email:a.email,phone:a.phone,address:a.address}))},ue=async(s,a)=>{s.preventDefault(),await re(a,w),R(null)},ye=()=>{R(null),k({name:"",email:"",phone:"",address:""})},be=s=>{ce(a=>{const n=new Set(a);return n.has(s)?n.delete(s):n.add(s),n})},q=s=>{x===s?U(p==="asc"?"desc":"asc"):(K(s),U("asc"))},D=(s,a,n)=>{const i=z(new Date,"yyyy-MM-dd_HH-mm-ss"),d=`clients_${a}_${i}.${n}`;if(n==="csv"){const f=[["Nom","Email","TÃ©lÃ©phone","Adresse","Date d'inscription"].join(","),...s.map(L=>[`"${L.name}"`,`"${L.email||""}"`,`"${L.phone}"`,`"${L.address||""}"`,`"${z(new Date(L.createdAt),"yyyy-MM-dd HH:mm:ss")}"`].join(","))].join(`
`),T=new Blob([f],{type:"text/csv;charset=utf-8;"}),j=document.createElement("a");j.href=URL.createObjectURL(T),j.download=d,j.click()}else{const r=JSON.stringify(s.map(j=>({id:j.id,name:j.name,email:j.email,phone:j.phone,address:j.address,createdAt:j.createdAt})),null,2),f=new Blob([r],{type:"application/json;charset=utf-8;"}),T=document.createElement("a");T.href=URL.createObjectURL(f),T.download=d,T.click()}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:`text-2xl font-semibold ${t?"text-white":"text-gray-900"}`,children:"Clients"}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsxs("button",{onClick:()=>_("main"),className:`flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm ${$==="main"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(X,{className:"h-4 w-4"}),"CrÃ©er un client"]}),e.jsxs("button",{onClick:()=>_("all"),className:`flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm ${$==="all"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(Z,{className:"h-4 w-4"}),"Tous les clients (",M.length,")"]})]})}),$==="main"&&e.jsxs("div",{className:`rounded-lg ${t?"bg-gray-800":"bg-white"} shadow p-6`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(X,{className:"h-5 w-5 text-indigo-600"}),e.jsx("h2",{className:`text-lg font-semibold ${t?"text-white":"text-gray-900"}`,children:"CrÃ©er un nouveau client"})]}),e.jsxs("form",{onSubmit:me,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium ${t?"text-gray-300":"text-gray-700"} mb-2`,children:["Nom ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:N.name,onChange:s=>C({...N,name:s.target.value}),placeholder:"Nom complet du client",className:`w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 ${t?"bg-gray-700 border-gray-600 text-white":"bg-white"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t?"text-gray-300":"text-gray-700"} mb-2`,children:"Email"}),e.jsx("input",{type:"email",value:N.email,onChange:s=>C({...N,email:s.target.value}),placeholder:"email@exemple.com",className:`w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 ${t?"bg-gray-700 border-gray-600 text-white":"bg-white"}`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium ${t?"text-gray-300":"text-gray-700"} mb-2`,children:["TÃ©lÃ©phone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",value:N.phone,onChange:s=>C({...N,phone:s.target.value}),placeholder:"+33 6 XX XX XX XX",className:`w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 ${t?"bg-gray-700 border-gray-600 text-white":"bg-white"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t?"text-gray-300":"text-gray-700"} mb-2`,children:"Adresse"}),e.jsx("textarea",{value:N.address,onChange:s=>C({...N,address:s.target.value}),placeholder:"Adresse complÃ¨te",rows:3,className:`w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 ${t?"bg-gray-700 border-gray-600 text-white":"bg-white"}`})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:[e.jsx("button",{type:"button",onClick:()=>{C({name:"",email:"",phone:"",address:""})},className:"px-6 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:"RÃ©initialiser"}),e.jsxs("button",{type:"submit",className:"px-6 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"CrÃ©er le client"]})]})]})]}),$==="all"&&e.jsxs(e.Fragment,{children:[ne&&e.jsx("div",{className:`rounded-lg ${t?"bg-gray-800":"bg-white"} shadow p-6 text-center`,children:e.jsx("p",{className:t?"text-white":"text-gray-900",children:"Chargement des clients..."})}),J&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:[e.jsx("strong",{className:"font-bold",children:"Error!"}),e.jsxs("span",{className:"block sm:inline",children:[" ",J]})]}),g.size>0&&e.jsx("div",{className:`rounded-lg ${t?"bg-gray-800":"bg-white"} shadow p-4 border-l-4 border-indigo-500`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${t?"bg-indigo-900 text-indigo-200":"bg-indigo-100 text-indigo-800"}`,children:[g.size," client",g.size>1?"s":""," sÃ©lectionnÃ©",g.size>1?"s":""]}),e.jsx("span",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Actions groupÃ©es:"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>{const s=y.filter(a=>g.has(a.id));D(s,"selected","csv")},className:"flex items-center gap-2 px-3 py-2 text-sm bg-green-600 text-white rounded-md hover:bg-green-700",children:[e.jsx(V,{className:"h-4 w-4"}),"Exporter CSV"]}),e.jsxs("button",{onClick:()=>{const s=y.filter(a=>g.has(a.id));D(s,"selected","json")},className:"flex items-center gap-2 px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[e.jsx(V,{className:"h-4 w-4"}),"Exporter JSON"]}),e.jsxs("button",{onClick:async()=>{if(window.confirm(`ÃŠtes-vous sÃ»r de vouloir supprimer ${g.size} client${g.size>1?"s":""} ?`)){for(const s of g)await O(s);E(new Set)}},className:"flex items-center gap-2 px-3 py-2 text-sm bg-red-600 text-white rounded-md hover:bg-red-700",children:[e.jsx(se,{className:"h-4 w-4"}),"Supprimer"]}),e.jsx("button",{onClick:()=>E(new Set),className:`px-3 py-2 text-sm rounded-md border ${t?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"DÃ©sÃ©lectionner"})]})]})}),e.jsx("div",{className:`rounded-lg ${t?"bg-gray-800":"bg-white"} shadow p-4`,children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(we,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Rechercher des clients...",value:b,onChange:s=>B(s.target.value),className:`w-full pl-10 pr-4 py-2 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 ${t?"bg-gray-700 border-gray-600 text-white":"bg-white"}`})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>q("name"),className:`px-3 py-2 text-sm rounded-md border ${x==="name"?"bg-indigo-100 text-indigo-700 border-indigo-300":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:["Nom ",x==="name"&&(p==="asc"?"â†‘":"â†“")]}),e.jsxs("button",{onClick:()=>q("email"),className:`px-3 py-2 text-sm rounded-md border ${x==="email"?"bg-indigo-100 text-indigo-700 border-indigo-300":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:["Email ",x==="email"&&(p==="asc"?"â†‘":"â†“")]}),e.jsxs("button",{onClick:()=>q("createdAt"),className:`px-3 py-2 text-sm rounded-md border ${x==="createdAt"?"bg-indigo-100 text-indigo-700 border-indigo-300":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:["Date ",x==="createdAt"&&(p==="asc"?"â†‘":"â†“")]})]})]}),e.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:y.length>0&&y.every(s=>g.has(s.id)),onChange:s=>{if(s.target.checked){const a=new Set(g);y.forEach(n=>a.add(n.id)),E(a)}else{const a=new Set(g);y.forEach(n=>a.delete(n.id)),E(a)}},className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),e.jsx("span",{className:`text-sm font-medium ${t?"text-gray-300":"text-gray-700"}`,children:"Tout sÃ©lectionner"}),g.size>0&&e.jsxs("span",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:["(",g.size," sÃ©lectionnÃ©",g.size>1?"s":"",")"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:`text-sm font-medium ${t?"text-gray-300":"text-gray-700"}`,children:"Mode d'affichage:"}),e.jsxs("div",{className:"flex rounded-md border border-gray-300",children:[e.jsx("button",{onClick:()=>{F(!1),m(1)},className:`px-3 py-1 text-sm rounded-l-md ${h?"text-gray-700 hover:bg-gray-50":"bg-indigo-600 text-white"}`,children:"Pagination"}),e.jsx("button",{onClick:()=>{F(!0),W(10)},className:`px-3 py-1 text-sm rounded-r-md ${h?"bg-indigo-600 text-white":"text-gray-700 hover:bg-gray-50"}`,children:"Charger plus"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>S(!Y),className:`flex items-center gap-2 px-3 py-2 text-sm rounded-md border ${t?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(V,{className:"h-4 w-4"}),"Exporter",e.jsx(te,{className:"h-3 w-3"})]}),Y&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-5",onClick:()=>S(!1)}),e.jsx("div",{className:`absolute right-0 mt-2 w-56 rounded-md shadow-xl border ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} z-10`,children:e.jsxs("div",{className:"py-1",children:[e.jsx("div",{className:"px-3 py-2 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Exporter les donnÃ©es"}),e.jsx("button",{onClick:()=>{D(y,"current","csv"),S(!1)},className:`block w-full text-left px-4 py-2 text-sm ${t?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-100"}`,children:"ðŸ“„ Page actuelle (CSV)"}),e.jsx("button",{onClick:()=>{D(u,"all","csv"),S(!1)},className:`block w-full text-left px-4 py-2 text-sm ${t?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-100"}`,children:"ðŸ“Š Tous les clients (CSV)"}),e.jsx("div",{className:`border-t ${t?"border-gray-700":"border-gray-200"}`}),e.jsx("button",{onClick:()=>{D(y,"current","json"),S(!1)},className:`block w-full text-left px-4 py-2 text-sm ${t?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-100"}`,children:"ðŸ’¾ Page actuelle (JSON)"}),e.jsx("button",{onClick:()=>{D(u,"all","json"),S(!1)},className:`block w-full text-left px-4 py-2 text-sm ${t?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-100"}`,children:"ðŸ’½ Tous les clients (JSON)"})]})})]})]}),h&&e.jsxs("div",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:["Affichage de ",y.length," sur ",u.length," clients"]})]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[u.length===0?e.jsxs("div",{className:`rounded-lg ${t?"bg-gray-800":"bg-white"} shadow p-8 text-center`,children:[e.jsx(Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:`text-lg ${t?"text-gray-400":"text-gray-500"}`,children:b?"Aucun client trouvÃ©":"Aucun client enregistrÃ©"}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:b?"Essayez une recherche diffÃ©rente":"Commencez par crÃ©er votre premier client"})]}):y.map(s=>{const{tickets:a,sales:n}=ge(s.id),i=ie===s.id,d=oe.has(s.id);return e.jsxs("div",{className:`rounded-lg ${t?"bg-gray-800":"bg-white"} shadow`,children:[e.jsx("div",{className:"p-4",children:le===s.id?e.jsxs("form",{onSubmit:r=>ue(r,s.id),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium ${t?"text-gray-300":"text-gray-700"} mb-1`,children:["Nom ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:w.name,onChange:r=>k({...w,name:r.target.value}),className:`w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 ${t?"bg-gray-700 border-gray-600 text-white":"bg-white"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t?"text-gray-300":"text-gray-700"} mb-1`,children:"Email"}),e.jsx("input",{type:"email",value:w.email,onChange:r=>k({...w,email:r.target.value}),className:`w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 ${t?"bg-gray-700 border-gray-600 text-white":"bg-white"}`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium ${t?"text-gray-300":"text-gray-700"} mb-1`,children:["TÃ©lÃ©phone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",value:w.phone,onChange:r=>k({...w,phone:r.target.value}),className:`w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 ${t?"bg-gray-700 border-gray-600 text-white":"bg-white"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t?"text-gray-300":"text-gray-700"} mb-1`,children:"Adresse"}),e.jsx("textarea",{value:w.address,onChange:r=>k({...w,address:r.target.value}),rows:2,className:`w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 ${t?"bg-gray-700 border-gray-600 text-white":"bg-white"}`})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white text-sm rounded-md hover:bg-indigo-700",children:"Sauvegarder"}),e.jsx("button",{type:"button",onClick:ye,className:"px-4 py-2 border border-gray-300 text-gray-700 text-sm rounded-md hover:bg-gray-50",children:"Annuler"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`flex justify-between items-start cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors px-4 py-3 -mx-4 -my-3 rounded-lg ${d?"bg-gray-50 dark:bg-gray-700/30":""}`,onClick:r=>{r.target.closest("button")||be(s.id)},children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:g.has(s.id),onChange:r=>{r.stopPropagation();const f=new Set(g);r.target.checked?f.add(s.id):f.delete(s.id),E(f)},className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),d?e.jsx(te,{className:"h-4 w-4 text-indigo-600"}):e.jsx(ve,{className:"h-4 w-4 text-indigo-600"}),e.jsx(X,{className:"h-4 w-4 text-gray-400"})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("h3",{className:`text-lg font-semibold ${t?"text-white":"text-gray-900"}`,children:s.name}),e.jsxs("span",{className:`px-2 py-1 text-xs rounded-full ${t?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-600"}`,children:["ðŸ“ž ",s.phone]})]})})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx("button",{onClick:r=>{r.stopPropagation(),de(i?null:s.id)},className:`p-2 rounded-full ${i?"bg-indigo-100 text-indigo-600":"text-gray-400 hover:text-gray-500"}`,title:"Historique",children:e.jsx($e,{className:"h-5 w-5"})}),e.jsx("button",{onClick:r=>{r.stopPropagation(),he(s.id)},className:"p-2 text-gray-400 hover:text-gray-500",title:"Modifier",children:e.jsx(Ce,{className:"h-5 w-5"})}),e.jsx("button",{onClick:r=>{r.stopPropagation(),xe(s.id)},className:"p-2 text-gray-400 hover:text-red-500",title:"Supprimer",children:e.jsx(se,{className:"h-5 w-5"})})]})]}),d&&e.jsx("div",{className:`mt-4 pt-4 border-t ${t?"border-gray-700":"border-gray-200"}`,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-medium mb-1 ${t?"text-gray-300":"text-gray-700"}`,children:"Email"}),e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:s.email||"Non spÃ©cifiÃ©"})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-medium mb-1 ${t?"text-gray-300":"text-gray-700"}`,children:"Adresse"}),e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:s.address||"Non spÃ©cifiÃ©e"})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-medium mb-1 ${t?"text-gray-300":"text-gray-700"}`,children:"ID Client"}),e.jsx("p",{className:`text-sm font-mono ${t?"text-gray-400":"text-gray-600"}`,children:s.id})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-medium mb-1 ${t?"text-gray-300":"text-gray-700"}`,children:"Membre depuis"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:z(new Date(s.createdAt),"MMM d, yyyy")})]})]})]})})]})}),i&&e.jsxs("div",{className:"mt-6 border-t pt-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h4",{className:`font-semibold ${t?"text-white":"text-gray-900"}`,children:"Historique du client"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:`text-sm font-medium mb-2 ${t?"text-gray-300":"text-gray-700"}`,children:"Tickets de rÃ©paration"}),e.jsx("div",{className:"space-y-2",children:a.length>0?a.map(r=>e.jsxs("div",{className:`p-3 rounded-md ${t?"bg-gray-700":"bg-gray-50"}`,children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:t?"text-white":"text-gray-900",children:[r.deviceType," - ",r.brand]}),e.jsxs("span",{className:`text-sm ${t?"text-gray-300":"text-gray-600"}`,children:["â‚¬",r.cost]})]}),e.jsxs("p",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:["TÃ¢ches: ",r.tasks.join(", ")]}),r.issue&&e.jsxs("p",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:["ProblÃ¨me: ",r.issue]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("span",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:["Statut: ",r.status]}),e.jsx("span",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:z(new Date(r.createdAt),"MMM d, yyyy")})]})]},r.id)):e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:"Aucun ticket de rÃ©paration pour le moment"})})]}),e.jsxs("div",{children:[e.jsx("h5",{className:`text-sm font-medium mb-2 ${t?"text-gray-300":"text-gray-700"}`,children:"Historique d'achat"}),e.jsx("div",{className:"space-y-2",children:n.length>0?n.map(r=>e.jsxs("div",{className:`p-3 rounded-md ${t?"bg-gray-700":"bg-gray-50"}`,children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:t?"text-white":"text-gray-900",children:["Facture ",r.invoiceNumber]}),e.jsxs("span",{className:`text-sm ${t?"text-gray-300":"text-gray-600"}`,children:["â‚¬",r.total.toFixed(2)]})]}),e.jsx("div",{className:"mt-1",children:e.jsxs("p",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:[r.items.length," article(s): ",r.items.slice(0,2).map(f=>f.name).join(", "),r.items.length>2?"...":""]})}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("span",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:["Type: Vente PDV â€¢ Paiement: ",r.paymentMethod]}),e.jsx("span",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:z(new Date(r.date),"MMM d, yyyy")})]})]},`sale-${r.id}`)):e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:"Aucun historique d'achat pour le moment"})})]})]})]})]},s.id)}),h&&y.length<u.length&&e.jsx("div",{className:"flex justify-center pt-6",children:e.jsxs("button",{onClick:()=>W(s=>s+10),className:"px-6 py-3 bg-indigo-600 text-white text-sm font-medium rounded-md hover:bg-indigo-700 flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"Charger 10 clients supplÃ©mentaires"]})}),!h&&c>1&&e.jsx("div",{className:`rounded-lg ${t?"bg-gray-800":"bg-white"} shadow p-4`,children:e.jsxs("div",{className:"flex flex-col lg:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:`text-sm ${t?"text-gray-400":"text-gray-600"} text-center lg:text-left`,children:["Affichage de ",P+1,"-",Math.min(A,u.length)," sur ",u.length," clients"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Par page:"}),e.jsxs("select",{value:v,onChange:s=>{Q(Number(s.target.value)),m(1)},className:`rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm ${t?"bg-gray-700 border-gray-600 text-white":"bg-white"}`,children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"Aller Ã :"}),e.jsx("input",{type:"number",min:1,max:c,value:o,onChange:s=>{const a=Number(s.target.value);a>=1&&a<=c&&m(a)},onKeyDown:s=>{if(s.key==="Enter"){const a=Number(s.target.value);a>=1&&a<=c&&m(a)}},className:`w-16 text-center rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm ${t?"bg-gray-700 border-gray-600 text-white":"bg-white"}`}),e.jsxs("span",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:["/ ",c]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-center",children:[e.jsx("button",{onClick:()=>m(1),disabled:o===1,className:`px-2 py-2 text-sm rounded-md border ${o===1?"border-gray-300 text-gray-400 cursor-not-allowed":"border-gray-300 text-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,title:"PremiÃ¨re page",children:"âŸª"}),e.jsx("button",{onClick:()=>m(Math.max(1,o-1)),disabled:o===1,className:`px-3 py-2 text-sm rounded-md border ${o===1?"border-gray-300 text-gray-400 cursor-not-allowed":"border-gray-300 text-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"PrÃ©cÃ©dent"}),e.jsx("div",{className:"flex gap-1",children:Array.from({length:Math.min(5,c)},(s,a)=>{let n;return c<=5||o<=3?n=a+1:o>=c-2?n=c-4+a:n=o-2+a,e.jsx("button",{onClick:()=>m(n),className:`px-3 py-2 text-sm rounded-md border min-w-[40px] ${o===n?"bg-indigo-600 text-white border-indigo-600":"border-gray-300 text-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:n},n)})}),e.jsx("button",{onClick:()=>m(Math.min(c,o+1)),disabled:o===c,className:`px-3 py-2 text-sm rounded-md border ${o===c?"border-gray-300 text-gray-400 cursor-not-allowed":"border-gray-300 text-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Suivant"}),e.jsx("button",{onClick:()=>m(c),disabled:o===c,className:`px-2 py-2 text-sm rounded-md border ${o===c?"border-gray-300 text-gray-400 cursor-not-allowed":"border-gray-300 text-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,title:"DerniÃ¨re page",children:"âŸ«"})]})]})})]})]})]})}export{Le as default};
