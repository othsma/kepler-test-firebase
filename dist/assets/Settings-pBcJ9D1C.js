import{j as e}from"./vendor-pdf-renderer-Bmei4UPz.js";import{r as n}from"./vendor-react-DSd34EeT.js";import{u as Y,a as V}from"./index-Bitl2p2P.js";import{j as q,r as N,I as f,T as w,Z as k,_ as C,n as ee,$ as se,d as ae,C as te,a0 as re,a1 as B,a2 as de,a3 as ie}from"./vendor-ui-Cgar-0cM.js";import"./vendor-firebase-BtFjE0-F.js";import"./vendor-utils-Bnff-AKO.js";import"./vendor-pdf-utils-CBrSDip1.js";function he(){const o=Y(s=>s.isDarkMode),{settings:r,addDeviceType:A,removeDeviceType:F,updateDeviceType:K,addBrand:z,removeBrand:P,updateBrand:R,addModel:U,removeModel:W,updateModel:Z,addTask:_,removeTask:G,updateTask:H,tickets:J}=V(),[g,M]=n.useState(""),[h,L]=n.useState(""),[i,T]=n.useState({name:"",brandId:""}),[u,E]=n.useState(""),[l,I]=n.useState({type:"",value:""}),[c,O]=n.useState(()=>{try{return localStorage.getItem("settingsActiveTab")||"deviceTypes"}catch{return"deviceTypes"}}),[m,Q]=n.useState(""),[p,S]=n.useState(new Set),[$,x]=n.useState("");n.useEffect(()=>{try{localStorage.setItem("settingsActiveTab",c)}catch(s){console.error("Error saving active tab to localStorage:",s)}},[c]),n.useEffect(()=>{x("")},[c,g,h,i,u]);const b=s=>{switch(x(""),s){case"deviceType":if(g.trim()){const a=g.trim();if(r.deviceTypes.some(d=>d.toLowerCase()===a.toLowerCase())){x(`Le type d'appareil "${a}" existe déjà.`);return}A(a),M("")}break;case"brand":if(h.trim()){const a=h.trim();if(r.brands.some(d=>d.toLowerCase()===a.toLowerCase())){x(`La marque "${a}" existe déjà.`);return}z(a),L("")}break;case"model":if(i.name.trim()&&i.brandId){const a=i.name.trim();if(r.models.some(d=>d.brandId===i.brandId&&d.name.toLowerCase()===a.toLowerCase())){const d=r.brands.find(t=>t===i.brandId)||i.brandId;x(`Le modèle "${a}" existe déjà pour la marque "${d}".`);return}U({name:a,brandId:i.brandId}),T({name:"",brandId:""})}break;case"task":if(u.trim()){const a=u.trim();if(r.tasks.some(d=>d.toLowerCase()===a.toLowerCase())){x(`La tâche "${a}" existe déjà.`);return}_(a),E("")}break}},y=(s,a,d)=>{if(l.type===s&&l.value===a){I({type:"",value:""});return}I({type:s,value:a,id:d})},j=(s,a,d,t)=>{switch(s){case"deviceType":K(a,d);break;case"brand":R(a,d);break;case"model":t&&Z(t,d);break;case"task":H(a,d);break}I({type:"",value:""})},D=s=>J.filter(a=>a.brand===s?!0:a.tasks.some(d=>r.models.filter(t=>t.brandId===s).some(t=>d.toLowerCase().includes(t.name.toLowerCase())))).length,X=[{id:"deviceTypes",label:"Types d'appareils",icon:q},{id:"brands",label:"Marques",icon:k},{id:"models",label:"Modèles",icon:C},{id:"tasks",label:"Tâches",icon:B}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:`text-2xl font-semibold ${o?"text-white":"text-gray-900"}`,children:"Paramètres"}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:X.map(s=>{const a=s.icon;return e.jsxs("button",{onClick:()=>O(s.id),className:`flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm ${c===s.id?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(a,{className:"h-4 w-4"}),s.label]},s.id)})})}),$&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",children:[e.jsx("span",{className:"block sm:inline",children:$}),e.jsx("button",{onClick:()=>x(""),className:"absolute top-0 bottom-0 right-0 px-4 py-3",children:e.jsx("span",{className:"text-red-700 text-xl",children:"×"})})]}),e.jsxs("div",{className:`rounded-lg ${o?"bg-gray-800":"bg-white"} shadow p-6`,children:[c==="deviceTypes"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(q,{className:"h-5 w-5 text-indigo-600"}),e.jsx("h2",{className:`text-lg font-semibold ${o?"text-white":"text-gray-900"}`,children:"Types d'appareils"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:g,onChange:s=>M(s.target.value),placeholder:"Ajouter un nouveau type d'appareil",className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),e.jsx("button",{onClick:()=>b("deviceType"),className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:e.jsx(N,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"space-y-2",children:r.deviceTypes.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md",children:[l.type==="deviceType"&&l.value===s?e.jsx("input",{type:"text",defaultValue:s,onKeyDown:a=>{a.key==="Enter"&&j("deviceType",s,a.currentTarget.value)},className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",autoFocus:!0}):e.jsx("span",{children:s}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>y("deviceType",s),className:"p-1 text-gray-400 hover:text-gray-600",children:e.jsx(f,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>F(s),className:"p-1 text-gray-400 hover:text-red-500",children:e.jsx(w,{className:"h-4 w-4"})})]})]},s))})]}),c==="brands"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(k,{className:"h-5 w-5 text-indigo-600"}),e.jsx("h2",{className:`text-lg font-semibold ${o?"text-white":"text-gray-900"}`,children:"Marques"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:h,onChange:s=>L(s.target.value),placeholder:"Ajouter une nouvelle marque",className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),e.jsx("button",{onClick:()=>b("brand"),className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:e.jsx(N,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"space-y-2",children:r.brands.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md",children:[l.type==="brand"&&l.value===s?e.jsx("input",{type:"text",defaultValue:s,onKeyDown:a=>{a.key==="Enter"&&j("brand",s,a.currentTarget.value)},className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",autoFocus:!0}):e.jsx("span",{children:s}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>y("brand",s),className:"p-1 text-gray-400 hover:text-gray-600",children:e.jsx(f,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>P(s),className:"p-1 text-gray-400 hover:text-red-500",children:e.jsx(w,{className:"h-4 w-4"})})]})]},s))})]}),c==="models"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5 text-indigo-600"}),e.jsx("h2",{className:`text-lg font-semibold ${o?"text-white":"text-gray-900"}`,children:"Modèles"}),e.jsxs("span",{className:`text-sm ${o?"text-gray-400":"text-gray-600"}`,children:["(",r.models.length," modèles au total)"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:()=>{const s=r.brands.filter(d=>r.models.some(t=>t.brandId===d)),a=s.every(d=>p.has(d));S(a?new Set:new Set(s))},className:"flex items-center gap-2 px-3 py-1 text-sm bg-indigo-100 text-indigo-700 rounded-md hover:bg-indigo-200",children:(()=>{const a=r.brands.filter(t=>r.models.some(v=>v.brandId===t)).every(t=>p.has(t)),d=a?de:ie;return e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"h-4 w-4"}),a?"Tout replier":"Tout déplier"]})})()})})]}),e.jsx("div",{className:"bg-white dark:bg-gray-700 p-4 rounded-lg border border-gray-200 dark:border-gray-600",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ee,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:m,onChange:s=>Q(s.target.value),placeholder:"Rechercher des modèles...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-800 dark:text-white"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[r.brands.filter(s=>r.models.some(a=>a.brandId===s&&(m===""||a.name.toLowerCase().includes(m.toLowerCase())))).length," marque",r.brands.filter(s=>r.models.some(a=>a.brandId===s)).length>1?"s":""," visible",r.brands.filter(s=>r.models.some(a=>a.brandId===s)).length>1?"s":""]})]})]})}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:"Ajouter un nouveau modèle"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:i.brandId,onChange:s=>T({...i,brandId:s.target.value}),className:"rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[e.jsx("option",{value:"",children:"Sélectionner une marque"}),r.brands.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsx("input",{type:"text",value:i.name,onChange:s=>T({...i,name:s.target.value}),placeholder:"Nom du modèle",className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:!i.brandId}),e.jsx("button",{onClick:()=>b("model"),disabled:!i.brandId||!i.name.trim(),className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(N,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"space-y-4",children:[r.brands.map(s=>{const a=r.models.filter(t=>t.brandId===s&&(m===""||t.name.toLowerCase().includes(m.toLowerCase())));if(a.length===0)return null;const d=p.has(s);return e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 px-4 py-3 border-b border-gray-200 dark:border-gray-600 cursor-pointer hover:bg-indigo-100 dark:hover:bg-indigo-900/30 transition-colors",onClick:()=>{const t=new Set(p);d?t.delete(s):t.add(s),S(t)},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[d?e.jsx(ae,{className:"h-4 w-4 text-indigo-600"}):e.jsx(te,{className:"h-4 w-4 text-indigo-600"}),e.jsx(k,{className:"h-4 w-4 text-indigo-600"}),e.jsx("h4",{className:"font-medium text-indigo-900 dark:text-indigo-100",children:s}),e.jsxs("span",{className:"text-sm text-indigo-600 dark:text-indigo-400",children:["(",a.length," modèle",a.length>1?"s":"",")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4 text-indigo-500"}),e.jsxs("span",{className:"text-xs text-indigo-600 dark:text-indigo-400",children:["Utilisé dans ",D(s)," ticket",D(s)!==1?"s":""]})]})]})}),d&&e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:a.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-gray-700",children:[l.type==="model"&&l.id===t.id?e.jsx("input",{type:"text",defaultValue:t.name,onKeyDown:v=>{v.key==="Enter"&&j("model",t.name,v.currentTarget.value,t.id)},className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",autoFocus:!0}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"font-medium",children:t.name}),m&&t.name.toLowerCase().includes(m.toLowerCase())&&e.jsx("span",{className:"px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full",children:"Correspondance"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>y("model",t.name,t.id),className:"p-1 text-gray-400 hover:text-gray-600",title:"Modifier",children:e.jsx(f,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>W(t.id),className:"p-1 text-gray-400 hover:text-red-500",title:"Supprimer",children:e.jsx(w,{className:"h-4 w-4"})})]})]},t.id))})]},s)}),r.brands.filter(s=>!r.models.some(a=>a.brandId===s)).length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:["Marques sans modèles (",r.brands.filter(s=>!r.models.some(a=>a.brandId===s)).length,")"]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:r.brands.filter(s=>!r.models.some(a=>a.brandId===s)).map(s=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-100 dark:bg-gray-700 rounded-md",children:[e.jsx(k,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:s})]},s))})]}),r.models.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(C,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:`text-lg ${o?"text-gray-400":"text-gray-500"}`,children:"Aucun modèle trouvé"}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Commencez par ajouter des marques, puis créez des modèles associés."})]})]})]}),c==="tasks"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(B,{className:"h-5 w-5 text-indigo-600"}),e.jsx("h2",{className:`text-lg font-semibold ${o?"text-white":"text-gray-900"}`,children:"Tâches"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:u,onChange:s=>E(s.target.value),placeholder:"Ajouter une nouvelle tâche",className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),e.jsx("button",{onClick:()=>b("task"),className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:e.jsx(N,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"space-y-2",children:r.tasks.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md",children:[l.type==="task"&&l.value===s?e.jsx("input",{type:"text",defaultValue:s,onKeyDown:a=>{a.key==="Enter"&&j("task",s,a.currentTarget.value)},className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",autoFocus:!0}):e.jsx("span",{children:s}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>y("task",s),className:"p-1 text-gray-400 hover:text-gray-600",children:e.jsx(f,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>G(s),className:"p-1 text-gray-400 hover:text-red-500",children:e.jsx(w,{className:"h-4 w-4"})})]})]},s))})]})]})]})}export{he as default};
