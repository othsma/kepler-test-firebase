import{j as e}from"./vendor-pdf-renderer-D6MgxH8g.js";import{r as x}from"./vendor-react-NkhADs9z.js";import{u as T,b as L,a as E,e as H}from"./index-CwyvYSKN.js";import{l as I,k as O,v as P,H as q,w as Q,T as R}from"./vendor-ui-CGQIwG7M.js";import{f as g}from"./vendor-utils-BK9ZHHVQ.js";import"./vendor-firebase-CWMDWzYz.js";import"./vendor-pdf-utils-MoZnrVgS.js";function V(){const t=T(s=>s.isDarkMode),{clients:u,searchQuery:h,setSearchQuery:p,addClient:j,updateClient:b,deleteClient:N,loading:f,error:y}=L(),{tickets:w}=E(),{orders:v}=H(),[C,o]=x.useState(!1),[n,m]=x.useState(null),[$,k]=x.useState(null),[r,l]=x.useState({name:"",email:"",phone:"",address:""}),S=u.filter(s=>{const d=h.toLowerCase();return s.name.toLowerCase().includes(d)||s.email.toLowerCase().includes(d)||s.phone.toLowerCase().includes(d)||s.address.toLowerCase().includes(d)}),M=async s=>{s.preventDefault(),n?(await b(n,r),m(null)):(await j(r),o(!1)),l({name:"",email:"",phone:"",address:""})},A=s=>{const d=w.filter(i=>i.clientId===s),c=v.filter(i=>i.clientId===s);return{tickets:d,orders:c}},D=async s=>{window.confirm("Are you sure you want to delete this client?")&&await N(s)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:`text-2xl font-semibold ${t?"text-white":"text-gray-900"}`,children:"Clients"}),e.jsxs("button",{onClick:()=>o(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),"Add Client"]})]}),e.jsxs("div",{className:"flex items-center gap-4 bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:[e.jsx(O,{className:"h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search clients...",value:h,onChange:s=>p(s.target.value),className:"flex-1 bg-transparent border-0 focus:ring-0 text-gray-900 dark:text-white placeholder-gray-400"})]}),f&&e.jsx("div",{className:`rounded-lg ${t?"bg-gray-800":"bg-white"} shadow p-6 text-center`,children:e.jsx("p",{className:t?"text-white":"text-gray-900",children:"Loading clients..."})}),y&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:[e.jsx("strong",{className:"font-bold",children:"Error!"}),e.jsxs("span",{className:"block sm:inline",children:[" ",y]})]}),(C||n)&&e.jsxs("div",{className:`rounded-lg ${t?"bg-gray-800":"bg-white"} shadow p-6`,children:[e.jsx("h2",{className:`text-lg font-semibold mb-4 ${t?"text-white":"text-gray-900"}`,children:n?"Edit Client":"Add New Client"}),e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t?"text-gray-300":"text-gray-700"}`,children:"Name"}),e.jsx("input",{type:"text",value:r.name,onChange:s=>l({...r,name:s.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t?"text-gray-300":"text-gray-700"}`,children:"Email"}),e.jsx("input",{type:"email",value:r.email,onChange:s=>l({...r,email:s.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t?"text-gray-300":"text-gray-700"}`,children:"Phone"}),e.jsx("input",{type:"tel",value:r.phone,onChange:s=>l({...r,phone:s.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t?"text-gray-300":"text-gray-700"}`,children:"Address"}),e.jsx("textarea",{value:r.address,onChange:s=>l({...r,address:s.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{type:"button",onClick:()=>{o(!1),m(null),l({name:"",email:"",phone:"",address:""})},className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700",children:n?"Update":"Add"})]})]})]}),e.jsx("div",{className:"grid gap-6",children:S.map(s=>{const{tickets:d,orders:c}=A(s.id),i=$===s.id;return e.jsxs("div",{className:`rounded-lg ${t?"bg-gray-800":"bg-white"} shadow p-6`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h3",{className:`text-lg font-semibold ${t?"text-white":"text-gray-900"}`,children:s.name}),e.jsxs("span",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:["ID: ",s.id]})]}),e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:s.email}),e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:s.phone}),e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:s.address}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(P,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:["Member since: ",g(new Date(s.createdAt),"MMM d, yyyy")]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{k(i?null:s.id)},className:`p-2 rounded-full ${i?"bg-indigo-100 text-indigo-600":"text-gray-400 hover:text-gray-500"}`,children:e.jsx(q,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>{m(s.id),l({name:s.name,email:s.email,phone:s.phone,address:s.address})},className:"p-2 text-gray-400 hover:text-gray-500",children:e.jsx(Q,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>D(s.id),className:"p-2 text-gray-400 hover:text-red-500",children:e.jsx(R,{className:"h-5 w-5"})})]})]}),i&&e.jsxs("div",{className:"mt-6 border-t pt-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h4",{className:`font-semibold ${t?"text-white":"text-gray-900"}`,children:"Client History"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:`text-sm font-medium mb-2 ${t?"text-gray-300":"text-gray-700"}`,children:"Repair Tickets"}),e.jsx("div",{className:"space-y-2",children:d.length>0?d.map(a=>e.jsxs("div",{className:`p-3 rounded-md ${t?"bg-gray-700":"bg-gray-50"}`,children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:t?"text-white":"text-gray-900",children:[a.deviceType," - ",a.brand]}),e.jsxs("span",{className:`text-sm ${t?"text-gray-300":"text-gray-600"}`,children:["$",a.cost]})]}),e.jsxs("p",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:["Tasks: ",a.tasks.join(", ")]}),a.issue&&e.jsxs("p",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:["Issue: ",a.issue]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("span",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:["Status: ",a.status]}),e.jsx("span",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:g(new Date(a.createdAt),"MMM d, yyyy")})]})]},a.id)):e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:"No repair tickets yet"})})]}),e.jsxs("div",{children:[e.jsx("h5",{className:`text-sm font-medium mb-2 ${t?"text-gray-300":"text-gray-700"}`,children:"Purchase History"}),e.jsx("div",{className:"space-y-2",children:c.length>0?c.map(a=>e.jsxs("div",{className:`p-3 rounded-md ${t?"bg-gray-700":"bg-gray-50"}`,children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:t?"text-white":"text-gray-900",children:["Order #",a.id]}),e.jsxs("span",{className:`text-sm ${t?"text-gray-300":"text-gray-600"}`,children:["$",a.total]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("span",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:["Status: ",a.status]}),e.jsx("span",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:g(new Date(a.createdAt),"MMM d, yyyy")})]})]},a.id)):e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:"No purchase history yet"})})]})]})]})]},s.id)})})]})}export{V as default};
